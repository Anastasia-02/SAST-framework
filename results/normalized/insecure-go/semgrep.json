{
  "tool": "semgrep",
  "project": "insecure-go",
  "timestamp": "2026-01-13T18:25:40.643139",
  "duration_seconds": 9.876481056213379,
  "issues": [
    {
      "id": "b2dc3489-5bff-4fbc-96e2-207df590d1cd",
      "tool": "Semgrep OSS",
      "rule_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query",
      "rule_name": "go.lang.security.audit.database.string-formatted-query.string-formatted-query",
      "file_path": "vulnerable.go",
      "line_number": 21,
      "column_number": 5,
      "end_line": 21,
      "end_column": 73,
      "severity": "warning",
      "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.",
      "snippet": "    query := fmt.Sprintf(\"SELECT * FROM users WHERE id = %s\", userInput)",
      "raw_data": {
        "fingerprints": {
          "matchBasedId/v1": "requires login"
        },
        "locations": [
          {
            "physicalLocation": {
              "artifactLocation": {
                "uri": "/src/vulnerable.go",
                "uriBaseId": "%SRCROOT%"
              },
              "region": {
                "endColumn": 73,
                "endLine": 21,
                "snippet": {
                  "text": "    query := fmt.Sprintf(\"SELECT * FROM users WHERE id = %s\", userInput)"
                },
                "startColumn": 5,
                "startLine": 21
              }
            }
          }
        ],
        "message": {
          "text": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data."
        },
        "properties": {},
        "ruleId": "go.lang.security.audit.database.string-formatted-query.string-formatted-query"
      }
    },
    {
      "id": "3136ee9c-2f21-45bb-aca0-71e07d7aa05f",
      "tool": "Semgrep OSS",
      "rule_id": "go.lang.security.audit.sqli.gosql-sqli.gosql-sqli",
      "rule_name": "go.lang.security.audit.sqli.gosql-sqli.gosql-sqli",
      "file_path": "vulnerable.go",
      "line_number": 22,
      "column_number": 18,
      "end_line": 22,
      "end_column": 33,
      "severity": "warning",
      "message": "Detected string concatenation with a non-literal variable in a \"database/sql\" Go SQL statement. This could lead to SQL injection if the variable is user-controlled and not properly sanitized. In order to prevent SQL injection, use parameterized queries or prepared statements instead. You can use prepared statements with the 'Prepare' and 'PrepareContext' calls.",
      "snippet": "    rows, err := db.Query(query)",
      "raw_data": {
        "fingerprints": {
          "matchBasedId/v1": "requires login"
        },
        "locations": [
          {
            "physicalLocation": {
              "artifactLocation": {
                "uri": "/src/vulnerable.go",
                "uriBaseId": "%SRCROOT%"
              },
              "region": {
                "endColumn": 33,
                "endLine": 22,
                "snippet": {
                  "text": "    rows, err := db.Query(query)"
                },
                "startColumn": 18,
                "startLine": 22
              }
            }
          }
        ],
        "message": {
          "text": "Detected string concatenation with a non-literal variable in a \"database/sql\" Go SQL statement. This could lead to SQL injection if the variable is user-controlled and not properly sanitized. In order to prevent SQL injection, use parameterized queries or prepared statements instead. You can use prepared statements with the 'Prepare' and 'PrepareContext' calls."
        },
        "properties": {},
        "ruleId": "go.lang.security.audit.sqli.gosql-sqli.gosql-sqli"
      }
    },
    {
      "id": "112c6e82-26c8-44e2-aeb6-9b0092c2430c",
      "tool": "Semgrep OSS",
      "rule_id": "go.lang.security.audit.dangerous-exec-command.dangerous-exec-command",
      "rule_name": "go.lang.security.audit.dangerous-exec-command.dangerous-exec-command",
      "file_path": "vulnerable.go",
      "line_number": 31,
      "column_number": 12,
      "end_line": 31,
      "end_column": 55,
      "severity": "warning",
      "message": "Detected non-static command inside Command. Audit the input to 'exec.Command'. If unverified user data can reach this call site, this is a code injection vulnerability. A malicious actor can inject a malicious script to execute arbitrary code.",
      "snippet": "    cmd := exec.Command(\"sh\", \"-c\", \"echo \"+userInput)",
      "raw_data": {
        "fingerprints": {
          "matchBasedId/v1": "requires login"
        },
        "locations": [
          {
            "physicalLocation": {
              "artifactLocation": {
                "uri": "/src/vulnerable.go",
                "uriBaseId": "%SRCROOT%"
              },
              "region": {
                "endColumn": 55,
                "endLine": 31,
                "snippet": {
                  "text": "    cmd := exec.Command(\"sh\", \"-c\", \"echo \"+userInput)"
                },
                "startColumn": 12,
                "startLine": 31
              }
            }
          }
        ],
        "message": {
          "text": "Detected non-static command inside Command. Audit the input to 'exec.Command'. If unverified user data can reach this call site, this is a code injection vulnerability. A malicious actor can inject a malicious script to execute arbitrary code."
        },
        "properties": {},
        "ruleId": "go.lang.security.audit.dangerous-exec-command.dangerous-exec-command"
      }
    }
  ],
  "issue_count": 3,
  "issues_by_severity": {
    "warning": 3
  },
  "metadata": {}
}